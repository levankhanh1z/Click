local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local mine = game.Workspace.Mine -- Điều chỉnh đường dẫn đến Mine của bạn
local pickaxe = game.Workspace.Debris.Plr.tking12z.Pickaxe.Pickaxe

local function handleClickAndFireServer(part)
    print("Auto Clicked on", part.Name)

    local partCFrame = part.CFrame
    local clickPosition = part.Position

    local remoteEventName = "MineEvent"  -- Thay đổi thành tên sự kiện từ xa bạn đang sử dụng

    local pinglessMineEvent = ReplicatedStorage:FindFirstChild("PinglessMine")
    local mineOreEvent = ReplicatedStorage:FindFirstChild("MineOre")
    local mineEvent = part:FindFirstChild(remoteEventName)

    if pinglessMineEvent then
        local args = {partCFrame, clickPosition}
        pinglessMineEvent:FireServer(unpack(args))
    else
        warn("RemoteEvent 'PinglessMine' not found.")
    end

    if mineOreEvent then
        local args = {partCFrame, clickPosition}
        mineOreEvent:FireServer(unpack(args))
    else
        warn("RemoteEvent 'MineOre' not found.")
    end

    if mineEvent then
        local args = {partCFrame, clickPosition}
        mineEvent:FireServer(unpack(args))
    else
        warn("RemoteEvent '" .. remoteEventName .. "' not found.")
    end
end

local function handleSelectionChange(partName)
    if partName then
        for _, part in pairs(mine:GetChildren()) do
            if part:IsA("Part") and part.Name == partName then
                -- Cập nhật SelectionBox của Pickaxe để hiển thị thông tin của Part
                pickaxe.Selection.Adornee = part

                -- Tự động click vào Part
                handleClickAndFireServer(part)

                break -- Chỉ xử lý một Part cần click
            end
        end
    end
end

-- Theo dõi sự kiện SelectionChanged của SelectionBox
pickaxe.Selection.SelectionChanged:Connect(function()
    local selectedAdornee = pickaxe.Selection.Adornee
    if selectedAdornee and selectedAdornee:IsA("Part") then
        -- Xử lý thay đổi trong Adornee, ở đây bạn có thể kiểm tra tên của Part và thực hiện hành động tương ứng
        local partName = selectedAdornee.Name
        handleSelectionChange(partName)
    end
end)
