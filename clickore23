local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local UserInputService = game:GetService("UserInputService")

local maxClickDistance = 10
local pickaxe = game.Workspace.Debris.Plr.tking12z.Pickaxe  -- Điều chỉnh đường dẫn đến Pickaxe của bạn
local mine = game.Workspace.Mine -- Điều chỉnh đường dẫn đến Mine của bạn

local function isPartNearPlayer(part)
    local playerPosition = Players.LocalPlayer.Character and Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart") and Players.LocalPlayer.Character.HumanoidRootPart.Position
    if playerPosition then
        local partPosition = part.Position
        local distance = (playerPosition - partPosition).Magnitude
        return distance <= maxClickDistance
    end
    return false
end

local function handleClickAndFireServer(part)
    print("Auto Clicked on", part.Name)

    if isPartNearPlayer(part) then
        local partCFrame = part.CFrame
        local clickPosition = part.Position

        local remoteEventName = "MineEvent"  -- Thay đổi thành tên sự kiện từ xa bạn đang sử dụng

        local pinglessMineEvent = ReplicatedStorage:FindFirstChild("PinglessMine")
        local mineOreEvent = ReplicatedStorage:FindFirstChild("MineOre")
        local mineEvent = part:FindFirstChild(remoteEventName)

        if pinglessMineEvent then
            local args = {partCFrame, clickPosition}
            pinglessMineEvent:FireServer(unpack(args))
        else
            warn("RemoteEvent 'PinglessMine' not found.")
        end

        if mineOreEvent then
            local args = {partCFrame, clickPosition}
            mineOreEvent:FireServer(unpack(args))
        else
            warn("RemoteEvent 'MineOre' not found.")
        end

        if mineEvent then
            local args = {partCFrame, clickPosition}
            mineEvent:FireServer(unpack(args))
        else
            warn("RemoteEvent '" .. remoteEventName .. "' not found.")
        end
    end
end

local function handleMouseClick()
    UserInputService.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            local mouseTarget = UserInputService.MouseTarget
            if mouseTarget and mouseTarget:IsA("Part") and mine:FindFirstChild(mouseTarget.Name) then
                -- Thực hiện sự kiện click khi người chơi click vào Part
                handleClickAndFireServer(mouseTarget)
            end
        end
    end)
end

-- Theo dõi sự kiện click chuột
handleMouseClick()
