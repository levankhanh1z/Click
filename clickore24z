local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local maxClickDistance = 50
local mine = game.Workspace.Mine -- Điều chỉnh đường dẫn đến Mine của bạn

local function isPartNearPlayer(part)
    local playerPosition = Players.LocalPlayer.Character and Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart") and Players.LocalPlayer.Character.HumanoidRootPart.Position
    if playerPosition then
        local partPosition = part.Position
        local distance = (playerPosition - partPosition).Magnitude
        return distance <= maxClickDistance
    end
    return false
end

local function handleClickAndFireServer(part)
    print("Auto Clicked on", part.Name)

    local partCFrame = part.CFrame
    local clickPosition = part.Position

    local remoteEventName = "MineEvent"  -- Thay đổi thành tên sự kiện từ xa bạn đang sử dụng

    local pinglessMineEvent = ReplicatedStorage:FindFirstChild("PinglessMine")
    local mineOreEvent = ReplicatedStorage:FindFirstChild("MineOre")
    local mineEvent = part:FindFirstChild(remoteEventName)

    if pinglessMineEvent then
        local args = {partCFrame, clickPosition}
        pinglessMineEvent:FireServer(unpack(args))
    else
        warn("RemoteEvent 'PinglessMine' not found.")
    end

    if mineOreEvent then
        local args = {partCFrame, clickPosition}
        mineOreEvent:FireServer(unpack(args))
    else
        warn("RemoteEvent 'MineOre' not found.")
    end

    if mineEvent then
        local args = {partCFrame, clickPosition}
        mineEvent:FireServer(unpack(args))
    else
        warn("RemoteEvent '" .. remoteEventName .. "' not found.")
    end
end

-- Kiểm tra và tự động click vào mỗi Part trong Mine
for _, part in pairs(mine:GetChildren()) do
    if part:IsA("Part") then
        if isPartNearPlayer(part) then
            handleClickAndFireServer(part)
        end
    end
end
